{% extends 'base.html' %}

{% block nav %}

<a href="" id="nav" class="navbar-brand" style="width: 100%; text-align: center;">
ATS Feedback for <small>ATS{{record.id}}</small>
</a>

{% endblock %}

{% block main %}

<style>
    h2{
        color: var(--c2);
        margin-bottom: 20px;
    }
    strong{
        font-size: 22px;
        text-decoration: underline;
        font-weight: 900;
        letter-spacing: 1px;
        color: green;
    }
    p{
        font-size: 18px;
    }
    @media print {
        body * {
            visibility: hidden;
        }
        #output, #output *,#nav{
            visibility: visible;
        }
        #output {
            position: absolute;
            left: 0;
            top: 10;
        }
        .credit{
            position: absolute;
            bottom: 5px;
            right: 5px;
        }
        
    }
</style>

<div class="container">
    
<nav style="--bs-breadcrumb-divider: url(&#34;data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' width='8' height='8'%3E%3Cpath d='M2.5 0L1 1.5 3.5 4 1 6.5 2.5 8l4-4-4-4z' fill='currentColor'/%3E%3C/svg%3E&#34;);" aria-label="breadcrumb">
    <ol class="breadcrumb">
      <li class="breadcrumb-item"><a style="color:var(--c1); text-decoration: none;"href="{% url 'index' %}"> <i class="fas fa-home"></i></a></li>

      <li class="breadcrumb-item"><a style="color:var(--c1); text-decoration: none;"href="{% url 'ats' %}">ATS</a></li>
      <li class="breadcrumb-item "><a style="color:var(--c2); text-decoration: none;" href="{% url 'ats_history' %}">Records</a></li>
      <li class="breadcrumb-item active" aria-current="page">ATS{{record.id}}</li>
    </ol>
  </nav>
</div>
<br>
<div id="output" class="container item-center">

</div>

<div class="container">
    <button class="btn sub-btn" onclick="printDiv('output')">Save to PDF</button>
</div>

<script>
    // Sample response object
    var response = JSON.parse('{{ record.responce|escapejs }}')

    // Function to create and append elements to the DOM
    function displayResponse(response) {
        var outputDiv = document.getElementById("output");

        // Create elements
        var heading = document.createElement("h2");
        heading.textContent = "Resume Feedback";

        var scorePara = document.createElement("p");
        scorePara.innerHTML = "<strong>Score:</strong>&nbsp;&nbsp;" + response.score + " / 10.";

        var descriptionPara = document.createElement("p");
        descriptionPara.innerHTML = "<strong>Description:</strong> " + response.description;

        var tipsPara = document.createElement("p");
        tipsPara.innerHTML = "<strong>Tips:</strong> " + response.tips;

        var myFeedbackPara = document.createElement("p");
        myFeedbackPara.innerHTML = "<strong>My Feedback:</strong> " + response.myfeedback;

        var credit = document.createElement("p");
        credit.classList.add("credit")
        credit.id = 'credit';
        // credit.innerHTML = "<strong>Credit :</strong> &copy; Generated By Neuraa [ATS] on {{record.created}}";


        // Append elements to the output div
        outputDiv.appendChild(heading);
        outputDiv.appendChild(scorePara);
        outputDiv.appendChild(descriptionPara);
        outputDiv.appendChild(tipsPara);
        outputDiv.appendChild(myFeedbackPara);
        outputDiv.appendChild(credit);
    }

    // Call the function with the response
    displayResponse(response);

    // Function to print the content of a specific div
    function printDiv(divId) {
        document.getElementById("credit").innerHTML = "&copy; Generated by <a href='{% url 'ats' %}' >Neuraa  [ATS]</a> at {{record.created}}"

        var printContents = document.getElementById(divId).innerHTML;
        var originalContents = document.body.innerHTML;

        document.body.innerHTML = printContents;
        window.print();

        document.body.innerHTML = originalContents;
    }
</script>

{% endblock %}
